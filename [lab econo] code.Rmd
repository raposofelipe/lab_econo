---
title: "R Notebook"
output: html_notebook
---

# Pacotes

```{r}
if (!require("curl")) install.packages("curl")
if (!require("tidyverse")) install.packages("tidyverse")
if (!require("archive")) install.packages("archive")
```

# Função(ões)

Essa função baixa os arquivos, descompacta e, por fim, remove o zip
```{r}
baixar_censo <- function(ano, ...) {
  # url de armazenamento dos dados
  url <- glue::glue("https://download.inep.gov.br/dados_abertos/microdados_censo_escolar_{ano}.zip")
  
  # não tem só a base :( vem dicionário junto e laialaia, paciência
  
  caminho_zip <- file.path("C:/Users/rapos/Graduacao - UnB/Econometria/Zoghbi/[lab econo] dados",
                       paste0("microdados_censo_escolar_", ano, ".zip"))
  pasta <- file.path("C:/Users/rapos/Graduacao - UnB/Econometria/Zoghbi/[lab econo] dados",
                     paste0("microdados_censo_escolar_", ano)) # onde vai ficar armazenado depois 
  
  curl::curl_download(url, destfile = caminho_zip)
  
  archive::archive_extract(caminho_zip, dir = pasta) # descompactar
  
  file.remove(caminho_zip) # remove, vamo salvar espaço colega
  }
```

# Download

```{r}
walk(2009:2019, baixar_censo)
```

# Base 

```{r}
censo_2009 <- read.csv2("C:/Users/rapos/Graduacao - UnB/Econometria/Zoghbi/[lab econo] dados/microdados_censo_escolar_2009/microdados_ed_basica_2009/dados/microdados_ed_basica_2009.csv")
```

```{r}
censo_2009 %>% 
  select(
    c(
      # Identificacao
      1:13, ## geral
      16, 
      287, # fundamental
      
      # subindices
      # Infra de servicos basicos (ib)
      ## 1- Local de funcionamento do prédio escolar
      ## 2- Existência de água filtrada
      ## 3- Existência de água rede publica
      ## 4- Existência de energia rede publica
      ## 5- Existência de esgoto rede publica
      ## 6- Existência de alimentação
      ## 7- Existência de lixo coleta periódica
      ## 8- Acesso à internet
      
      # Infra Fisica (if)
      
      128, ## Existencia de banheiro
      134, ## Existencia de biblioteca
      136, ## Existencia de cozinha
      140, ## Existencia de lab de ciencias
      141, ## Existencia de lab de informatica
      145, ## Existencia de parque infantil
      147, ## Existencia de quadra de esportes
      159, ## Existencia de sala de professor


      # Disponibilidade de Equipamentos (de)
      ## 1- Existência de equipamento de TV
      ## 2- Existência de equipamento de copiadora
      ## 3- Existência de equipamento de impressora
      ## 4- Existência de computador
      
      # Capacitacao de Discentes (cd)
      
      344, ## Existencia de escolas com Educacao Profissional
      346  ## Existencia de EJA
    )
  ) %>%
  filter(TP_DEPENDENCIA != 4)
```

